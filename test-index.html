<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8" />

  <title>SR 520 Construction | WSDOT</title>
   
  <link rel="stylesheet" media="all" href="/css/styles1.css" />
  <link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css"
    integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

  <link rel="stylesheet" media="all" href="/css/styles2.css" />
  <link rel="stylesheet" media="all" href="https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap" />
  <link rel="stylesheet" media="all" href="/css/styles3.css" />
  <link rel="stylesheet" media="all" href="/css/stylesheet-override.css" />
  <link rel="stylesheet" media="all"
    href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&amp;display=swap" />  <link rel="stylesheet" media="all"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css" />
  <script src="/Scripts/jquery-min.js"></script>

  <script src="https://kit.fontawesome.com/da8d22a218.js" crossorigin="anonymous"></script>
  <!-- leaftlet css js -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha512-IkGU/uDhB9u9F8k+2OsA6XXoowIhOuQL1NTgNZHY1nkURnqEGlDZq3GsfmdJdKFe1k1zOc6YU2K7qY+hF9AodA=="
    crossorigin=""></script>
   
      <style>
        #map {
          height: 800px;
          width: 100%;
        }
      </style>
    </head>
    <body>


        <div class="container-fluid">
            <div class="row">
              <div class="col-md-3">
                <form id="filterForm">
                  <div class="form-group" id="start">
                    <label>Start Date</label>
                    <input class="form-control" type="date" id="startDate" />
                  </div>
          
                  <div class="form-group" id="end">
                    <label>End Date</label>
                    <input class="form-control" type="date" id="endDate" />
                  </div>
          
                  <div class="form-group" id="constructionType">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="allConstruction">
                      <label class="form-check-label">All Construction</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fullHighwayClosures">
                      <label class="form-check-label">Full Highway Closures</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="partialHighwayClosures">
                      <label class="form-check-label">Partial Highway Closures</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="cameras">
                      <label class="form-check-label">Cameras</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="highImpactConstruction">
                      <label class="form-check-label">High Impact Construction</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="trailClosures">
                      <label class="form-check-label">Trail Closures</label>
                    </div>
          
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="rampClosures">
                      <label class="form-check-label">Ramp Closures</label>
                    </div>
                  </div>
          
                  <p></p>
          
                  <button class="btn btn-primary" type="submit">
                    Submit
                  </button>
                </form>
              </div>
          
              <div class="col-md-9">
                <div id="map" style="height: 800px; width: 100%;"></div>
              </div>
            </div>
          </div>
          
      
     <script>
        const constructionSites = [ {
    "coordinates": [47.64131, -122.295796],
    "message": "Road closed due to construction from May 10 to May 20.",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/orangecone-md.png",
    "iconSize": "40",
    "startDate": "2023-05-10",
    "endDate": "2023-05-20",
     "type": "Full Highway Closure"    
  },
  {
    "coordinates": [47.636191, -122.229373],
    "message": "Bridge work from May 15 to May 25.",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/red-dash.png",
    "iconSize": "40",
    "startDate": "2023-05-15",
    "endDate": "2023-05-25",          
    "type": "Partial Highway Closure"  
  },

  {
    "coordinates": [47.636763, -122.240021],
    "message": "Construction work from May 7 to May 30.",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/camera-green.png",
    "iconSize": "30",
    "startDate": "2023-05-07",
    "endDate": "2023-05-30",
    "type": "Camera"  
  },
  {
    "coordinates": [47.635606, -122.236944],
    "message": "<h2 style='font-size: 18px; font-weight: 600'>May 7 to June 30:</h2><p>Something about this.</p>",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/camera-green.png",
    "iconSize": "30",
    "startDate": "2023-05-07",
    "endDate": "2023-05-30",
      "type": "Full Highway Closure"   
  },
  {
    "coordinates": [47.641807, -122.316945],
    "message": "<h2 style='font-size: 18px; font-weight: 600'>May 25 to June 5:</h2><p>Construction, road remains open.</p>",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/caution2.png",
    "iconSize": "35",
    "startDate": "2023-05-25",
    "endDate": "2023-06-30",
      "type": "Full Highway Closure"   
  }, 

  {
    "coordinates": [47.643658, -122.291131],
    "message": "<h2 style='font-size: 18px; font-weight: 600'>May 22 to June 5:</h2><p>Construction, road remains open.</p>",
    "iconUrl": "https://sr520-beta2023.azurewebsites.net/Content/icons/camera-green.png",
    "iconSize": "30",
    "startDate": "2023-05-22",
    "endDate": "2023-06-05",
    "type": "Camera"   
  } ];
     

  function clearMarkers() {
      // Assuming you're clearing all markers from the map.
      map.eachLayer(function (layer) {
        map.removeLayer(layer);
      });
    }

    function createCustomIcon(iconUrl, size) {
      return L.icon({
        iconUrl: iconUrl,
        iconSize: [size, size],
        iconAnchor: [12, 41],
        popupAnchor: [0, -41],
        className: 'my-custom-icon'
      });
    }

    const constructionType = [];

    document.getElementById('allConstruction').addEventListener('change', function() {
      if (this.checked) {
        // Assuming you want to add all construction types when "all" is checked
        constructionType.push('residential', 'commercial', 'infrastructure');
      } else {
        // Assuming you want to remove all construction types when "all" is unchecked
        constructionType.splice(0, constructionType.length);
      }
    });

    // You would want to add other checkboxes in a similar manner
      
    // Fetch form and input elements
    const form = document.querySelector('#filterForm');
    const startDateInput = document.querySelector('#startDate');
    const endDateInput = document.querySelector('#endDate');

    form.addEventListener('submit', event => {
      event.preventDefault();
      const startDate = new Date(startDateInput.value);
      const endDate = new Date(endDateInput.value);
    
      if (startDate && endDate) {
        clearMarkers();
        // Pass startDate, endDate and constructionType to addMarkers function
        addMarkers(startDate, endDate, constructionType);
      }
    });

    // Initialize the Leaflet map
    const map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19
    }).addTo(map);

    // Function to add markers based on date range and construction type
    function addMarkers(startDate, endDate, constructionType) {
      constructionSites.forEach(site => {
        const siteStartDate = new Date(site.startDate);
        const siteEndDate = new Date(site.endDate);

        if (siteStartDate >= startDate && siteEndDate <= endDate && constructionType.includes(site.type)) {
          const customIcon = createCustomIcon(site.iconUrl, site.iconSize);
          L.marker([site.lat, site.lng], { icon: customIcon }).addTo(map)
            .bindPopup(`<b>${site.name}</b><br>${site.type}`);
        }
      });
    }



      </script>

  

    </body>
    </html>
    